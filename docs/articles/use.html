<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Use of GRASS interface • rgrass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Use of GRASS interface">
<meta property="og:description" content="rgrass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rgrass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/coerce.html">Coercion between object formats</a>
    </li>
    <li>
      <a href="../articles/use.html">Use of GRASS interface</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rsbivand/rgrass/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Use of GRASS interface</h1>
                        <h4 data-toc-skip class="author">Roger Bivand</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rsbivand/rgrass/blob/HEAD/vignettes/use.Rmd" class="external-link"><code>vignettes/use.Rmd</code></a></small>
      <div class="hidden name"><code>use.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The original R-GRASS interface <span class="citation">(Bivand 2000; Neteler and Mitasova 2008)</span> was written mainly to permit R objects represented as <strong>sp</strong> class objects to be moved to GRASS, and GRASS objects to be moved to R for statistical analysis. From <strong>spgrass6</strong> 0.6-3 (April 2009) following a fruitful workshop at Queen’s University, Belfast, the interface was re-written to use the <code>--interface-description</code> flag provided for each GRASS command, also used by the Python interface to GRASS commands. Command interface descriptions are parsed from XML and cached as R objects for efficiency. The current version of the R-GRASS interface is contained in this package, <strong>rgrass</strong>. In addition, an R function <code><a href="../reference/initGRASS.html">initGRASS()</a></code> was written to permit GRASS to be started from within GRASS to which we will return below.</p>
</div>
<div class="section level2">
<h2 id="starting-r-inside-grass">Starting R inside GRASS<a class="anchor" aria-label="anchor" href="#starting-r-inside-grass"></a>
</h2>
<p>When starting GRASS GIS from a terminal console (here GRASS 8.2.0), one can continue in the GRASS terminal console, starting an interactive R session from there (here R 4.2.1). Loading and attaching the R-GRASS interface package <strong>rgrass</strong> in the R session, we see that the current GRASS location is detected and reported:</p>
<pre><code>$ /home/rsb/topics/grass/g820/bin/grass /home/rsb/topics/grassdata/nc_basic_spm_grass7/rsb
Starting GRASS GIS...
Cleaning up temporary files...

          __________  ___   __________    _______________
         / ____/ __ \/   | / ___/ ___/   / ____/  _/ ___/
        / / __/ /_/ / /| | \__ \\_  \   / / __ / / \__ \
       / /_/ / _, _/ ___ |___/ /__/ /  / /_/ // / ___/ /
       \____/_/ |_/_/  |_/____/____/   \____/___//____/

Welcome to GRASS GIS 8.2.0
GRASS GIS homepage:                      https://grass.osgeo.org
This version running through:            Bash Shell (/bin/bash)
Help is available with the command:      g.manual -i
See the licence terms with:              g.version -c
See citation options with:               g.version -x
If required, restart the GUI with:       g.gui wxpython
When ready to quit enter:                exit

Launching &lt;wxpython&gt; GUI in the background, please wait...
GRASS nc_basic_spm_grass7/rsb:github-rsb &gt; R

R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

...

&gt; library(rgrass)
Loading required package: XML
GRASS GIS interface loaded with GRASS version: GRASS 8.2.0 (2022)
and location: nc_basic_spm_grass7</code></pre>
<p>Since <strong>rgrass</strong> <em>knows</em> the current location, we can for example use <code><a href="../reference/execGRASS.html">execGRASS()</a></code> to list GRASS rasters in the PERMANENT mapset in the standard North Carolina basic data set (<a href="https://grass.osgeo.org/sampledata/north_carolina/nc_basic_spm_grass7.zip" class="external-link uri">https://grass.osgeo.org/sampledata/north_carolina/nc_basic_spm_grass7.zip</a>):</p>
<pre><code>&gt; execGRASS("g.list", type="raster", mapset="PERMANENT")
basins
elevation
elevation_shade
geology
lakes
landuse
soils
&gt; q()
Save workspace image? [y/n/c]: n
GRASS nc_basic_spm_grass7/rsb:github-rsb &gt; exit
Cleaning up default sqlite database ...
Cleaning up temporary files...
Done.

Goodbye from GRASS GIS</code></pre>
<p>Leaving R returns us to the GRASS terminal console, which we can also exit.</p>
<p>R can also be started within the GRASS GUI, by choosing the console tab, and entering for example <code>rstudio</code>, or another R graphical user interface on Windows or macOS. This screendump shows the same listing of rasters in PERMANENT in <code>rstudio</code>:</p>
<p><img src="rstudio_in_GRASS.png" width="800"></p>
</div>
<div class="section level2">
<h2 id="starting-grass-inside-r">Starting GRASS inside R<a class="anchor" aria-label="anchor" href="#starting-grass-inside-r"></a>
</h2>
<p>From <strong>spgrass6</strong> 0.6-3, it has also been possible to start a GRASS session from a running R session using the <code><a href="../reference/initGRASS.html">initGRASS()</a></code> function. This is done by setting GRASS and environment variables from the R session (<a href="https://grass.osgeo.org/grass80/manuals/variables.html" class="external-link uri">https://grass.osgeo.org/grass80/manuals/variables.html</a>). Starting GRASS from R may use a temporary location, or may use an existing GRASS <code>LOCATION</code>.</p>
<div class="section level3">
<h3 id="temporary-grass-location">Temporary GRASS location<a class="anchor" aria-label="anchor" href="#temporary-grass-location"></a>
</h3>
<p>It may be useful to set an environmental variable to the value of <code>GISBASE</code>, as shown for example in the GRASS terminal console:</p>
<pre><code>GRASS nc_basic_spm_grass7/rsb:github-rsb &gt; echo $GISBASE
/home/rsb/topics/grass/g820/grass82</code></pre>
<p>Starting R with such a suitable environment variable set lets us retrieve it later when needed. When loaded and attached, <strong>rgrass</strong> reports that it seems that GRASS is not running:</p>
<pre><code>$ GRASS_INSTALLATION=/home/rsb/topics/grass/g820/grass82 R

R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

...

&gt; library(rgrass)
Loading required package: XML
GRASS GIS interface loaded with GRASS version: (GRASS not running)</code></pre>
<p>Here we’ll use a raster file provided with <strong>terra</strong>:</p>
<pre><code>&gt; library(terra)
terra 1.6.0
&gt; f &lt;- system.file("ex/elev.tif", package="terra")
&gt; r &lt;- rast(f)</code></pre>
<p>The first argument to <code><a href="../reference/initGRASS.html">initGRASS()</a></code> is <code>gisBase=</code>, which here we are passing the value of the environmental variable after checking that it is a directory. The second argument is where to write the <code>GISRC</code> file. The third is a template raster (here a <code>"SpatRaster"</code> object) from which to clone the temporary location size, position, resolution and projection:</p>
<pre><code>&gt; GRASS_INSTALLATION &lt;- Sys.getenv("GRASS_INSTALLATION")
&gt; file.info(GRASS_INSTALLATION)$isdir
[1] TRUE
&gt; loc &lt;- initGRASS(gisBase=GRASS_INSTALLATION, home=tempdir(), SG=r, override=TRUE)</code></pre>
<p>As can be seen, <code><a href="../reference/initGRASS.html">initGRASS()</a></code> creates not only environment and GRASS variables, but also many files in the location mapsets; <code>g.gisenv</code> also shows details:</p>
<pre><code>&gt; list.files(file.path(loc$GISDBASE, loc$LOCATION_NAME), recursive=TRUE)
[1] "file28aaf6dc1c44c/WIND"          "file28aaf6dc1c44c/windows/input"
[3] "PERMANENT/DEFAULT_WIND"          "PERMANENT/PROJ_EPSG"            
[5] "PERMANENT/PROJ_INFO"             "PERMANENT/PROJ_SRID"            
[7] "PERMANENT/PROJ_UNITS"            "PERMANENT/PROJ_WKT"             
[9] "PERMANENT/WIND"                 
&gt; execGRASS("g.gisenv")
GISDBASE='/tmp/Rtmpe7QdVd';
LOCATION_NAME='file28aaf5be4b905';
MAPSET='file28aaf6dc1c44c';
GRASS_GUI='text';</code></pre>
<p>We may now write R objects to the temporary GRASS location for manipulation and analysis, here calculating slope and aspect layers:</p>
<pre><code>&gt; write_RAST(r, vname="terra_elev")
Importing raster map &lt;terra_elev&gt;...
 100%
SpatRaster read into GRASS using r.in.gdal from file 
&gt; execGRASS("g.list", type="raster", mapset=loc$MAPSET)
terra_elev
&gt; execGRASS("r.slope.aspect", flags="overwrite", elevation="terra_elev", slope="slope", aspect="aspect")
 100%
Aspect raster map &lt;aspect&gt; complete
Slope raster map &lt;slope&gt; complete
&gt; u1 &lt;- read_RAST(c("terra_elev", "slope", "aspect"))
Checking GDAL data type and nodata value...
 100%
Using GDAL data type &lt;UInt16&gt;
Exporting raster data to RRASTER format...
 100%
r.out.gdal complete. File &lt;/tmp/RtmpLsAbI6/file29f4b33cd20f6.grd&gt; created.
Checking GDAL data type and nodata value...
 100%
Using GDAL data type &lt;Float32&gt;
Exporting raster data to RRASTER format...
 100%
r.out.gdal complete. File &lt;/tmp/RtmpLsAbI6/file29f4b2d2e045b.grd&gt; created.
Checking GDAL data type and nodata value...
 100%
Using GDAL data type &lt;Float32&gt;
Exporting raster data to RRASTER format...
 100%
r.out.gdal complete. File &lt;/tmp/RtmpLsAbI6/file29f4b52cab445.grd&gt; created.
&gt; u1
class       : SpatRaster 
dimensions  : 90, 95, 3  (nrow, ncol, nlyr)
resolution  : 0.008333326, 0.008333333  (x, y)
extent      : 5.741667, 6.533333, 49.44167, 50.19167  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
sources     : file29f4b33cd20f6.grd  
              file29f4b2d2e045b.grd  
              file29f4b52cab445.grd  
names       :   terra_elev,        slope,       aspect 
min values  : 141.00000000,   0.01416342,   0.08974174 
max values  :   547.000000,     7.229438,   360.000000 </code></pre>
</div>
<div class="section level3">
<h3 id="existing-grass-location">Existing GRASS location<a class="anchor" aria-label="anchor" href="#existing-grass-location"></a>
</h3>
<p>Similarly, GRASS may be started in an R session by providing the <code>gisDbase=</code>, “<code>location=</code> and <code>mapset=</code> arguments with valid values:</p>
<pre><code>$ GRASS_INSTALLATION=/home/rsb/topics/grass/g820/grass82 R

R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

...

&gt; library(rgrass)
Loading required package: XML
GRASS GIS interface loaded with GRASS version: (GRASS not running)
&gt; GRASS_INSTALLATION &lt;- Sys.getenv("GRASS_INSTALLATION")
&gt; loc &lt;- initGRASS(GRASS_INSTALLATION, home=tempdir(), gisDbase="/home/rsb/topics/grassdata", location="nc_basic_spm_grass7", mapset="rsb", override=TRUE)
&gt; execGRASS("g.gisenv")
GISDBASE='/home/rsb/topics/grassdata';
LOCATION_NAME='nc_basic_spm_grass7';
MAPSET='rsb';
GRASS_GUI='text';
&gt; execGRASS("g.list", type="raster", mapset="PERMANENT")
basins
elevation
elevation_shade
geology
lakes
landuse
soils</code></pre>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bivand:00" class="csl-entry">
Bivand, R. S. 2000. <span>“Using the <span>R</span> Statistical Data Analysis Language on <span>GRASS</span> 5.0 <span>GIS</span> Data Base Files.”</span> <em>Computers and Geosciences</em> 26: 1043–52.
</div>
<div id="ref-neteler+mitasova:08" class="csl-entry">
Neteler, M., and H. Mitasova. 2008. <em>Open Source <span>GIS</span>: A <span>GRASS</span> <span>GIS</span> Approach, Third Edition</em>. New York: Springer.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
